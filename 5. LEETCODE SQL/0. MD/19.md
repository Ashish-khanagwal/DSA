# Intuition

To solve this problem, we need to identify policyholders based on two specific conditions:

1. Their `tiv_2015` value is shared by at least one other policyholder.
2. Their location, defined by the pair `(lat, lon)`, is unique — no other policyholder has the same coordinates.

So the main idea is to first find:

- all `tiv_2015` values that occur more than once, and
- all `(lat, lon)` pairs that occur exactly once.

Then, we sum up the `tiv_2016` values of policyholders who satisfy both conditions.

---

# Approach

1. **Find duplicate `tiv_2015` values:**  
   Use a subquery with `GROUP BY tiv_2015 HAVING COUNT(*) > 1` to identify all `tiv_2015` values that appear more than once.

2. **Find unique locations:**  
   Use another subquery with `GROUP BY lat, lon HAVING COUNT(*) = 1` to get all unique coordinate pairs.

3. **Combine both conditions:**  
   In the main query, filter the `Insurance` table where:
   - `tiv_2015` is one of the repeating values.
   - `(lat, lon)` pair is one of the unique locations.

4. **Aggregate the result:**  
   Use `SUM(i.tiv_2016)` to sum all qualifying records and `ROUND(..., 2)` to round the result to two decimal places.

---

# Complexity

- **Time complexity:**  
  $$O(n)$$ — Each grouping operation (`GROUP BY tiv_2015` and `GROUP BY lat, lon`) scans the table once, making the overall time linear with respect to the number of records.

- **Space complexity:**  
  $$O(n)$$ — Additional space is used to store grouped results for subqueries.

---

# Code

```mysql []
# Write your MySQL query statement below
SELECT
    ROUND(SUM(i.tiv_2016), 2) AS tiv_2016
FROM Insurance i
WHERE i.tiv_2015 IN (
    SELECT tiv_2015
    FROM Insurance
    GROUP BY tiv_2015
    HAVING COUNT(*) > 1
)
AND (i.lat, i.lon) IN (
    SELECT lat, lon
    FROM Insurance
    GROUP BY lat, lon
    HAVING COUNT(*) = 1
);
```
