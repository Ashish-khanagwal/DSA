# Intuition

To classify each node as **Root**, **Inner**, or **Leaf**, we analyze the tree structure based on two attributes:

- The `p_id` column tells us whether a node has a parent.
- Nodes that appear as a `p_id` for other nodes must be **Inner** nodes (they have children).
- A node with no parent (`p_id IS NULL`) is the **Root**.
- Nodes that are not root and do not appear as any node’s parent are **Leaf** nodes.

# Approach

1. Use a `CASE` expression.
2. If `p_id IS NULL`, the node is **Root**.
3. Else, check if the node’s `id` exists in the set of parent ids (`p_id`) — if so, it's **Inner**.
4. Otherwise, it's a **Leaf**.

# Complexity

- **Time Complexity:**  
  The subquery `SELECT p_id FROM Tree` scans all rows once → **O(n)**.  
  The main query also scans all rows → **O(n)**.  
  Overall: **O(n)**.

- **Space Complexity:**  
  Only constant extra space is used → **O(1)**.

# Code

```mysql
SELECT
    t.id,
    CASE
        WHEN t.p_id IS NULL THEN 'Root'
        WHEN t.id IN (SELECT p_id FROM Tree WHERE p_id IS NOT NULL) THEN 'Inner'
        ELSE 'Leaf'
    END AS type
FROM Tree t;
```
