# Intuition

We need to find employees who act as **managers**, meaning at least one other employee reports directly to them.  
For each such manager, we must count how many employees report to them and compute the **average age** of those reports, rounded to the nearest integer.

Since both managers and employees are stored in the same table, a **self-join** is the natural solution.

---

# Approach

1. **Self-join the Employees table**
   - Treat one instance as the manager (`m`)
   - Treat the other as the reporting employee (`e`)
   - Join using `e.reports_to = m.employee_id`

2. **Aggregate reporting employees**
   - `COUNT(e.employee_id)` → number of direct reports
   - `AVG(e.age)` → average age of reports

3. **Round the average**
   - Use `ROUND()` to round to the nearest integer as required

4. **Group and order**
   - Group by manager’s `employee_id` and `name`
   - Order the final result by `employee_id`

---

# Complexity

- **Time complexity:**  
  $$O(n)$$  
  Each employee row is processed once in the join and aggregation.

- **Space complexity:**  
  $$O(1)$$ (excluding output)  
  No additional data structures are used beyond aggregation.

---

# Code

```mysql
SELECT
    m.employee_id,
    m.name,
    COUNT(e.employee_id) AS reports_count,
    ROUND(AVG(e.age)) AS average_age
FROM Employees m
JOIN Employees e
    ON e.reports_to = m.employee_id
GROUP BY m.employee_id, m.name
ORDER BY m.employee_id;
```
