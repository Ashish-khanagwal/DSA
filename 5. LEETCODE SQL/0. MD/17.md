# Intuition

We need to determine how many players logged in again on the day immediately following their **first login**. Once we have that number, we can divide it by the total number of distinct players to get the required fraction. Essentially, this problem asks for the **retention rate of players on the day after their first login**.

# Approach

1. **Find each player's first login date:**  
   Use a subquery with `MIN(event_date)` grouped by `player_id` to identify when each player first logged in.

2. **Check for next-day logins:**  
   Join the main `Activity` table with the subquery result. Use the condition  
   `DATEDIFF(a.event_date, b.first_login) = 1`  
   to find all cases where a player logged in exactly one day after their first login.

3. **Count distinct players who logged in again:**  
   Count how many unique players meet this condition.

4. **Compute the total number of players:**  
   Count all distinct `player_id` values from the `Activity` table.

5. **Calculate the fraction:**  
   Divide the count of players who logged in again by the total number of players, and round it to two decimal places.

# Complexity

- **Time complexity:**  
  $$O(n)$$ — Each record in the table is scanned once for aggregation and joining.
- **Space complexity:**  
  $$O(n)$$ — Additional space for storing grouped and joined intermediate results.

# Code

```mysql []
# Write your MySQL query statement below
SELECT
    ROUND(
        (
            SELECT COUNT(DISTINCT a.player_id)
            FROM Activity a
            JOIN (
                SELECT player_id, MIN(event_date) AS first_login
                FROM Activity
                GROUP BY player_id
            ) b
            ON a.player_id = b.player_id
            AND DATEDIFF(a.event_date, b.first_login) = 1
        )
        /
        (SELECT COUNT(DISTINCT player_id) FROM Activity),
        2
    ) AS fraction;
```
