# Problem: Salaries Differences

**Platform:** StrataScratch  
**Problem Link:** [Salaries Differences (ID 10308)](https://platform.stratascratch.com/coding/10308-salaries-differences?code_type=3)

## Objective

Calculate the **absolute difference** between the **highest salaries** in the **Marketing** and **Engineering** departments.  
Output only the numeric difference.

---

## Intuition

To find how much the top-paid employee in Marketing earns compared to the top-paid employee in Engineering,  
we only need to extract the **maximum salary** from each of these two departments and then compute their **difference**.  
Taking the **absolute value** ensures that the result is always a positive number regardless of which department pays more.

---

## Approach

1. **Join** the two tables `db_employee` and `db_dept` using the `department_id` field.
2. Use a **CASE WHEN** statement inside an **aggregate MAX()** function to extract the highest salary for each department:
   - `MAX(CASE WHEN department = 'marketing' THEN salary END)` gives the maximum salary in Marketing.
   - `MAX(CASE WHEN department = 'engineering' THEN salary END)` gives the maximum salary in Engineering.
3. Subtract the two maximum salaries to get the salary difference.
4. Wrap the result in the `ABS()` function to ensure the difference is non-negative.

---

## Final Query

```sql
SELECT
  ABS(
    MAX(CASE WHEN department = 'marketing' THEN salary END) -
    MAX(CASE WHEN department = 'engineering' THEN salary END)
  ) AS salary_difference
FROM db_employee
JOIN db_dept
  ON db_employee.department_id = db_dept.id;
```
