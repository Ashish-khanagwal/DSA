# Intuition

We need to find the last person in the queue such that the **cumulative weight** of people entering does **not exceed 1000**.  
Since the total weight depends on all previous turns, a simple filter on individual rows is not sufficient.  
This naturally suggests using a **running sum** ordered by `turn`.

---

# Approach

1. Use a **window function** to calculate the running total of `weight` ordered by `turn`.
2. Store this running total in a subquery because window function results cannot be filtered directly in the `WHERE` clause.
3. In the outer query:
   - Filter rows where `total_weight <= 1000`
   - Sort by `total_weight` in descending order to get the largest valid cumulative weight
   - Select the top row using `LIMIT 1`
4. Return only the `person_name`.

---

# Complexity

- **Time Complexity:**  
  $$O(n)$$ — each row is processed once to compute the running sum.

- **Space Complexity:**  
  $$O(n)$$ — due to the window function storing intermediate results.

---

# Code

```sql
SELECT person_name
FROM (
    SELECT
        person_name,
        SUM(weight) OVER (ORDER BY turn) AS total_weight
    FROM Queue
) t
WHERE total_weight <= 1000
ORDER BY total_weight DESC
LIMIT 1;
```
