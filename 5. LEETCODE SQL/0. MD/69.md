# Intuition

The problem asks for two independent results:

1. The user who has rated the greatest number of movies.
2. The movie with the highest average rating in February 2020.

Since these two answers are unrelated but must be displayed in a **single column**, the results need to be computed separately and then combined vertically.

# Approach

1. **First query (Top User):**
   - Use the `MovieRating` table to count how many movies each user has rated.
   - Group by `user_id` and `name`.
   - Sort by the count of rated movies in descending order.
   - Break ties by choosing the lexicographically smallest user name.
   - Limit the result to one row.

2. **Second query (Top Movie in Feb 2020):**
   - Filter the `MovieRating` table to include only ratings from February 2020.
   - Group by `movie_id` and `title`.
   - Compute the average rating for each movie.
   - Sort by the average rating in descending order.
   - Break ties by choosing the lexicographically smallest movie title.
   - Limit the result to one row.

3. Combine the outputs of both queries using `UNION ALL` so that they appear as two rows under the same column name `results`.

# Complexity

- **Time Complexity:**  
  Each subquery scans and aggregates the `MovieRating` table once, resulting in an overall time complexity of **O(n)**.
- **Space Complexity:**  
  No additional data structures are used beyond the result set â†’ **O(1)**.

# Code

```mysql
(
    SELECT u.name AS results
    FROM Users u
    JOIN MovieRating mr
        ON u.user_id = mr.user_id
    GROUP BY u.user_id, u.name
    ORDER BY COUNT(mr.movie_id) DESC, u.name ASC
    LIMIT 1
)

UNION ALL

(
    SELECT m.title AS results
    FROM Movies m
    JOIN MovieRating mr
        ON m.movie_id = mr.movie_id
    WHERE mr.created_at BETWEEN '2020-02-01' AND '2020-02-29'
    GROUP BY m.movie_id, m.title
    ORDER BY AVG(mr.rating) DESC, m.title ASC
    LIMIT 1
);
```
