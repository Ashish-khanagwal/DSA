# Intuition

For each query, we need to compute two metrics:

1. **Quality** — the average value of `rating / position`.
2. **Poor query percentage** — the percentage of records where the rating is less than 3.

Both metrics are calculated per `query_name`, so aggregation is required.

# Approach

1. Group the data by `query_name` so that each result row corresponds to a single query.
2. To compute **quality**:
   - Sum the values of `rating / position`.
   - Divide by the count of ratings to get the average.
   - Round the result to two decimal places.
3. To compute **poor query percentage**:
   - Use conditional aggregation to count how many rows have `rating < 3`.
   - Divide this count by the total number of rows for the query.
   - Multiply by 100 to convert it into a percentage.
   - Round the result to two decimal places.
4. Return both computed metrics for each query.

# Complexity

- **Time Complexity:**  
  The table is scanned once and grouped by `query_name`, resulting in **O(n)** time complexity.
- **Space Complexity:**  
  No additional space is used beyond the result set → **O(1)**.

# Code

```mysql
SELECT
    query_name,
    ROUND(
        SUM(rating / position) / COUNT(rating),
        2
    ) AS quality,
    ROUND(
        100.0 * SUM(CASE WHEN rating < 3 THEN 1 ELSE 0 END) / COUNT(*),
        2
    ) AS poor_query_percentage
FROM Queries
GROUP BY query_name;
```
