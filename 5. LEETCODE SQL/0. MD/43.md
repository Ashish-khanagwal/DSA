# Intuition

To determine how many orders each user made as a buyer in 2019, we need to count only the orders placed in that year while still including users who made **zero** purchases. This means the solution must preserve all users from the `Users` table regardless of their order activity.

# Approach

1. Start with the `Users` table because every user must appear in the output.
2. Use a **LEFT JOIN** with `Orders` on `buyer_id` so users with no orders are still included.
3. Apply the date filter for 2019 **inside the JOIN condition**, not in the `WHERE` clause.
   - This ensures users without 2019 orders don’t get filtered out (avoiding the LEFT JOIN turning into an INNER JOIN).
4. Count the number of matching order records using `COUNT(o.order_id)`, which naturally returns `0` for users with no matching rows.
5. Group by user_id and join_date to aggregate the counts correctly.

# Complexity

- **Time Complexity:**  
  Joining and grouping across users and orders takes **O(U + O)**, where U = number of users and O = number of orders.
- **Space Complexity:**  
  The query uses grouping and a join but no additional structures → **O(U)**.

# Code

```mysql
SELECT u.user_id AS buyer_id,
       u.join_date,
       COUNT(o.order_id) AS orders_in_2019
FROM Users u
LEFT JOIN Orders o
    ON u.user_id = o.buyer_id
   AND o.order_date BETWEEN '2019-01-01' AND '2019-12-31'
GROUP BY u.user_id, u.join_date;
```
