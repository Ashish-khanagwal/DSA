# Intuition

Each student can take multiple exams for the same subject on different dates.
To determine whether a student’s performance improved, we need to compare:

- the **score from the first exam** (earliest date)
- the **score from the latest exam** (most recent date)

The key challenge is that the _first_ and _latest_ scores are defined by
**exam dates**, not by the score values themselves.

---

# Approach

1. **Identify the first and latest exam dates** for each `(student_id, subject)`
   using window functions:
   - `MIN(exam_date)` → first exam date
   - `MAX(exam_date)` → latest exam date

2. **Extract the corresponding scores**:
   - Use conditional aggregation to pick the score when `exam_date`
     matches the first or latest date.

3. **Group by student and subject** to get one row per pair.

4. **Filter only improving cases**:
   - Keep rows where `latest_score > first_score`.

5. **Order the result** as required.

---

# Complexity

- **Time Complexity:**  
  $$O(n)$$ — each row is scanned a constant number of times.

- **Space Complexity:**  
  $$O(n)$$ — window functions create intermediate results.

---

# Code

```sql
SELECT
    student_id,
    subject,
    MAX(CASE WHEN exam_date = first_date THEN score END) AS first_score,
    MAX(CASE WHEN exam_date = latest_date THEN score END) AS latest_score
FROM (
    SELECT *,
        MIN(exam_date) OVER (PARTITION BY student_id, subject) AS first_date,
        MAX(exam_date) OVER (PARTITION BY student_id, subject) AS latest_date
    FROM Scores
) t
GROUP BY student_id, subject
HAVING latest_score > first_score
ORDER BY student_id, subject;
```
