# Intuition

To analyze monthly transaction performance by country, we need to aggregate multiple statistics such as total transactions, approved transactions, and total monetary amounts. Since transactions occur on specific dates, converting each date into a `YYYY-MM` format allows grouping by month. Grouping by both **country** and **month** generates a clear breakdown of activity in each region for each month.

# Approach

1. **Extract the month** using `DATE_FORMAT(trans_date, '%Y-%m')`.  
   This standardizes all dates into a year–month format.
2. **Group by both country and month** to compute metrics for each region per month.
3. **Compute transaction counts** using `COUNT(state)`.
4. **Compute approved transaction counts** using MySQL's boolean expression trick:  
   `SUM(state = 'approved')`, which adds `1` for approved rows and `0` otherwise.
5. **Calculate total transaction amount** using `SUM(amount)`.
6. **Calculate approved amount** using a `CASE WHEN` condition inside `SUM()`.
7. Present aggregated metrics grouped by `(country, month)`.

# Complexity

- **Time Complexity:**  
  Processing all rows once for grouping and aggregation → **O(n)**.
- **Space Complexity:**  
  Uses only intermediate stored values during aggregation → **O(1)** additional space.

# Code

```mysql
SELECT
    DATE_FORMAT(trans_date, '%Y-%m') AS month,
    country,
    COUNT(state) AS trans_count,
    SUM(state = 'approved') AS approved_count,
    SUM(amount) AS trans_total_amount,
    SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount
FROM Transactions
GROUP BY country, month;
```
