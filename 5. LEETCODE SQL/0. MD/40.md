# Intuition

To compute the average selling price of each product, we cannot simply average the prices.  
Products may have different prices during different time periods, and the number of units sold at each price varies.  
Therefore, we need to calculate a **weighted average**, where each price is weighted by the number of units sold at that price.  
If a product has no sales, its average price should be 0.

# Approach

1. Join the `Prices` and `UnitsSold` tables using:
   - `product_id`
   - `purchase_date` within the price period (`start_date` to `end_date`)
2. For each product:
   - Multiply `price * units` to get the total revenue contribution for each sale period.
   - Compute `SUM(price * units)` divided by `SUM(units)` to get the weighted average price.
3. Use `LEFT JOIN` to ensure products with **no sales** still appear in the output.
4. Use `IFNULL(..., 0)` to return a 0 average price when a product has no sales.
5. Apply `ROUND(..., 2)` to format the result to two decimal places.

# Complexity

- **Time Complexity:**  
  Joining and scanning both tables requires **O(n)** time, where _n_ is the number of total rows.
- **Space Complexity:**  
  Uses constant extra memory beyond the output â†’ **O(1)**.

# Code

```mysql
SELECT
    p.product_id,
    ROUND(
        IFNULL(SUM(p.price * u.units) / SUM(u.units), 0)
    , 2) AS average_price
FROM Prices p
LEFT JOIN UnitsSold u
    ON p.product_id = u.product_id
   AND u.purchase_date BETWEEN p.start_date AND p.end_date
GROUP BY p.product_id;

```
