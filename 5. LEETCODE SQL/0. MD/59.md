# Intuition

The original table stores product prices in a **wide format**, where each store has its own column.  
To make the data easier to analyze, we need to transform it into a **long format**, where each row represents  
a single `(product_id, store, price)` combination.  
Only non-null prices should be included in the result.

# Approach

1. Select the `product_id`, hardcode the store name, and extract the corresponding price for each store column.
2. Use one `SELECT` statement per store (`store1`, `store2`, `store3`).
3. Filter out rows where the price is `NULL` using `WHERE storeX IS NOT NULL`.
4. Combine all results vertically using `UNION ALL` to preserve all valid rows.

# Complexity

- **Time Complexity:**  
  The table is scanned once per store column. With a fixed number of stores, this is **O(n)**.
- **Space Complexity:**  
  The result uses linear space proportional to the number of non-null prices â†’ **O(n)**.

# Code

```mysql
SELECT product_id, 'store1' AS store, store1 AS price
FROM Products
WHERE store1 IS NOT NULL

UNION ALL

SELECT product_id, 'store2' AS store, store2 AS price
FROM Products
WHERE store2 IS NOT NULL

UNION ALL

SELECT product_id, 'store3' AS store, store3 AS price
FROM Products
WHERE store3 IS NOT NULL;
```
