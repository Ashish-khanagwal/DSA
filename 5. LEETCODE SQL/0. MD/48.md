# Intuition

The goal is to compute a **7-day rolling sum and average** of customer spending. Since multiple customers can visit on the same day, the first step is to aggregate all amounts per day. After that, a window function can compute rolling metrics for each date. Finally, we only output rows where the full 7-day window is available.

# Approach

1. **Aggregate daily spending**  
   Use a CTE (`daily`) to compute the total `daily_amount` for each `visited_on` date.

2. **Apply window functions**  
   Use `SUM(...) OVER` and `AVG(...) OVER` with a window frame  
   `ROWS BETWEEN 6 PRECEDING AND CURRENT ROW`  
   to compute:
   - the 7-day rolling sum
   - the 7-day rolling average
   - the number of days included in the window

3. **Filter to complete 7-day windows**  
   Only show rows where the window contains exactly 7 days.

4. **Round results** to two decimal places for clean output formatting.

# Complexity

- **Time Complexity:**  
  Aggregation + window operations each run once over the dataset → **O(n)**.

- **Space Complexity:**  
  The CTE and window operations require storing intermediate values → **O(n)**.

# Code

```mysql
WITH daily AS (
    SELECT visited_on,
           SUM(amount) AS daily_amount
    FROM Customer
    GROUP BY visited_on
)

SELECT visited_on,
       ROUND(sum_7, 2) AS amount,
       ROUND(avg_7, 2) AS average_amount
FROM (
    SELECT visited_on,
           SUM(daily_amount) OVER w AS sum_7,
           AVG(daily_amount) OVER w AS avg_7,
           COUNT(daily_amount) OVER w AS cnt_in_window
    FROM daily
    WINDOW w AS (
        ORDER BY visited_on
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    )
) t
WHERE cnt_in_window = 7
ORDER BY visited_on;
```
