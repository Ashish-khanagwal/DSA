# Intuition

Each user completes a sequence of courses over time.  
To understand **skill mastery pathways**, we focus on **high-performing users** and
analyze the **order in which they complete courses**. By examining consecutive
course transitions among these users, we can identify common learning paths that
successful students tend to follow.

---

# Approach

1. **Identify top-performing users**
   - Group by `user_id` and keep only users who:
     - Completed at least **5 courses**
     - Have an **average course rating of 4 or higher**

2. **Order courses chronologically**
   - For each top-performing user, sort completed courses by `completion_date`.
   - Use the `LEAD` window function to pair each course with the **next course**
     completed by the same user.

3. **Extract valid course transitions**
   - Remove rows where there is no next course (i.e., the last course in a userâ€™s
     sequence).

4. **Count transition frequencies**
   - Group by `(first_course, second_course)` and count how often each transition
     appears across all top performers.

5. **Sort the results**
   - Order by transition frequency (descending), then by course names in
     ascending order.

---

# Complexity

- **Time complexity:**  
  $$O(n)$$  
  Each course completion record is processed a constant number of times, and
  window functions operate linearly within each user partition.

- **Space complexity:**  
  $$O(n)$$  
  Intermediate CTEs store filtered users and ordered course sequences.

---

# Code

```mysql
WITH top_performers AS (
    SELECT
        user_id
    FROM course_completions
    GROUP BY user_id
    HAVING
        COUNT(*) >= 5
        AND AVG(course_rating) >= 4
),
ordered_courses AS (
    SELECT
        cc.user_id,
        cc.course_name AS first_course,
        LEAD(cc.course_name) OVER (
            PARTITION BY cc.user_id
            ORDER BY cc.completion_date
        ) AS second_course
    FROM course_completions cc
    JOIN top_performers tp
        ON cc.user_id = tp.user_id
),
course_pairs AS (
    SELECT
        first_course,
        second_course
    FROM ordered_courses
    WHERE second_course IS NOT NULL
)
SELECT
    first_course,
    second_course,
    COUNT(*) AS transition_count
FROM course_pairs
GROUP BY first_course, second_course
ORDER BY
    transition_count DESC,
    first_course ASC,
    second_course ASC;
```
