# Intuition

The key idea is to identify **consecutive days** where the number of people visiting the stadium is at least 100.  
If we can group rows that are consecutive in terms of `id`, then we can simply check which groups have a length of **at least 3 consecutive days**.

A common SQL trick for this is:

- Use `ROW_NUMBER()` to generate a sequence
- Subtract it from a stable increasing column (`id`)
- Equal differences indicate consecutive rows → same group

---

# Approach

1. **Filter rows first**
   - Only keep records where `people >= 100`.
   - This removes irrelevant days early and simplifies grouping.

2. **Assign group identifiers**
   - Use `ROW_NUMBER() OVER (ORDER BY id)` to number rows sequentially.
   - Compute `grp = id - ROW_NUMBER()`.
   - For consecutive `id` values, this difference remains constant → same group.

3. **Find valid groups**
   - Group by `grp` and keep only those with `COUNT(*) >= 3`.

4. **Return required rows**
   - Select all rows that belong to valid groups.
   - Order the result by `visit_date`.

---

# Complexity

- **Time complexity:**  
  $$O(n)$$  
  Each row is scanned a constant number of times.

- **Space complexity:**  
  $$O(n)$$  
  Due to window function and temporary result sets (CTEs).

---

# Code

```mysql
WITH filtered AS (
    SELECT *
    FROM Stadium
    WHERE people >= 100
),
numbered AS (
    SELECT
        id,
        visit_date,
        people,
        id - ROW_NUMBER() OVER (ORDER BY id) AS grp
    FROM filtered
)
SELECT
    id,
    visit_date,
    people
FROM numbered
WHERE grp IN (
    SELECT grp
    FROM numbered
    GROUP BY grp
    HAVING COUNT(*) >= 3
)
ORDER BY visit_date;
```
