# Intuition

We want to find books for which **all available copies are currently borrowed**.  
To do this, we must count how many active borrowing records exist for each book and compare that count with the total number of copies available for the book.

# Approach

1. Join the `library_books` table with the `borrowing_records` table using `book_id`.
2. Filter the records to include only **currently borrowed books** by checking `return_date IS NULL`.
3. Group the results by book-level attributes so that each row represents a single book.
4. Count the number of active borrowing records (`record_id`) to compute the number of current borrowers per book.
5. Use a `HAVING` clause to keep only those books where the number of current borrowers equals the total number of copies.
6. Order the results by the number of current borrowers in descending order and then by book title.

# Complexity

- **Time Complexity:**  
  The join and aggregation scan the borrowing records once, resulting in **O(n)** time complexity.
- **Space Complexity:**  
  No extra space is used beyond the result set â†’ **O(1)**.

# Code

```mysql
SELECT
    lb.book_id,
    lb.title,
    lb.author,
    lb.genre,
    lb.publication_year,
    COUNT(br.record_id) AS current_borrowers
FROM library_books lb
JOIN borrowing_records br
    ON lb.book_id = br.book_id
WHERE br.return_date IS NULL
GROUP BY
    lb.book_id,
    lb.title,
    lb.author,
    lb.genre,
    lb.publication_year,
    lb.total_copies
HAVING COUNT(br.record_id) = lb.total_copies
ORDER BY current_borrowers DESC, title;
```
